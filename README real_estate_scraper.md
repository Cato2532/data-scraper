# RU — Описание проекта

## Data Scraper: недвижимость (Tranio / HomesOverseas / Prian)

Скрипты для массового сбора карточек с сайтов, очистки данных и выгрузки в Excel.  
Поддерживаются: пагинация, дедупликация, обработка ошибок (429/не-200), извлечение площади/комнат, нормализация цены и расчёт *цены за м²*.  
Есть итоговый консолидированный отчёт: один Excel с отдельным листом на каждую страну.

---

## Что внутри (основные фичи)

* **Парсинг HTML**: `requests` + `BeautifulSoup` / `LxmlSoup`, устойчивость к пустым страницам и дублям
* **Очистка и расчёты**:
  - парсинг цены и конвертация валют → €
  - извлечение площади и комнат
  - расчёт цены за м²
  - единый набор колонок и нумерация
* **Экспорт в Excel (openpyxl)**:
  - «умные таблицы» с итогами и полосами
  - мини-сводные (средние) на листе
  - автоформат чисел
  - мультилистовый файл: по одной вкладке на страну
* **Агрегация**: чтение файлов по каждому сайту → объединение в один отчёт
* **Защита от блокировок**: паузы между запросами, повтор при 429

---

## Полезные кусочки кода (для переиспользования)

* Создание недостающих директорий перед сохранением
* Шаблон «умной таблицы» в Excel (Table, стиль, итоги)
* Добавление нескольких листов/таблиц в один файл
* Мини-сводная с формулами `SUBTOTAL`
* Универсальные функции для записи DataFrame в Excel с автоформатом

---

## Вход и выход

* **Вход**: веб-страницы сайтов, список стран и базовые пути сохранения:
  - !перед запуском кода нужно добавить папку с соответствующим названием на рабочий стол
<img width="90" height="289" alt="image" src="https://github.com/user-attachments/assets/177b00b3-3806-4429-a672-701b6dd34c1d" />
* **Выход**:  
  - набор Excel по сайтам (`/data/<Site>/<Страна>.xlsx`)
<img width="370" height="265" alt="image" src="https://github.com/user-attachments/assets/c7f23719-63d4-46f9-8d20-f58bb28184f2" /> <img width="1044" height="621" alt="image" src="https://github.com/user-attachments/assets/b626968a-d528-4049-94aa-f335bb2b8db5" />
  - общий отчёт `/output/Недвижимость.xlsx` с вкладками по странам
<img width="953" height="726" alt="image" src="https://github.com/user-attachments/assets/936b0d7b-b937-4f4e-99ec-a290017c2f05" />

---

## Ограничения и этика

* Разметка сайтов может меняться — селекторы обновлять по мере необходимости
* Соблюдать robots.txt и rate-limit (не уменьшать паузы, не завышать `max_pages`)
