# RU — Описание проекта

## Data Scraper: недвижимость (Tranio / HomesOverseas / Prian)

Скрипты для массового сбора карточек с сайтов, очистки данных и выгрузки в Excel.  
Поддерживаются: пагинация, дедупликация, обработка ошибок (429/не-200), извлечение площади/комнат, нормализация цены и расчёт *цены за м²*.  
Есть итоговый консолидированный отчёт: один Excel с отдельным листом на каждую страну.

---

## Что внутри (основные фичи)

* **Парсинг HTML**: `requests` + `BeautifulSoup` / `LxmlSoup`, устойчивость к пустым страницам и дублям
* **Очистка и расчёты**:
  - парсинг цены и конвертация валют → €
  - извлечение площади и комнат
  - расчёт цены за м²
  - единый набор колонок и нумерация
* **Экспорт в Excel (openpyxl)**:
  - «умные таблицы» с итогами и полосами
  - мини-сводные (средние) на листе
  - автоформат чисел
  - мультилистовый файл: по одной вкладке на страну
* **Агрегация**: чтение файлов по каждому сайту → объединение в один отчёт
* **Защита от блокировок**: паузы между запросами, повтор при 429

---

## Полезные кусочки кода (для переиспользования)

* Создание недостающих директорий перед сохранением
* Шаблон «умной таблицы» в Excel (Table, стиль, итоги)
* Добавление нескольких листов/таблиц в один файл
* Мини-сводная с формулами `SUBTOTAL`
* Универсальные функции для записи DataFrame в Excel с автоформатом

---

## Вход и выход

* **Вход**: веб-страницы сайтов, список стран и базовые пути сохранения  
* **Выход**:  
  - набор Excel по сайтам (`/data/<Site>/<Страна>.xlsx`)  
  - общий отчёт `/output/Недвижимость.xlsx` с вкладками по странам  

---

## Зависимости

`pandas`, `requests`, `beautifulsoup4`, `lxml`, `openpyxl`

---

## Ограничения и этика

* Разметка сайтов может меняться — селекторы обновлять по мере необходимости
* Соблюдать robots.txt и rate-limit (не уменьшать паузы, не завышать `max_pages`)
